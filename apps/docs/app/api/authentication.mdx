# Authentication

Learn how to authenticate with the Findoora API using API keys, OAuth, and other security methods.

## API Key Authentication

The simplest and most common way to authenticate with the Findoora API is using API keys.

### Getting Your API Key

import { Steps } from 'nextra/components'

<Steps>
### Access Account Settings

Navigate to [app.findoora.com/settings/api](https://app.findoora.com/settings/api) or go to Settings ‚Üí API in your dashboard.

### Generate New Key

Click "Generate New API Key" and provide a descriptive name for your key (e.g., "Mobile App", "Data Sync Script").

### Copy and Store Securely

Copy the generated key immediately - it will only be shown once. Store it securely in your environment variables.

### Test Your Key

Use the key in a test request to verify it's working correctly.
</Steps>

### Using API Keys

Include your API key in the `Authorization` header of every request:

```http
Authorization: Bearer YOUR_API_KEY
```

**Example with cURL:**
```bash
curl -H "Authorization: Bearer fnd_12345678901234567890abcdef" \
     https://api.findoora.com/v1/search?q=documents
```

**Example with JavaScript:**
```javascript
const response = await fetch('https://api.findoora.com/v1/search?q=documents', {
  headers: {
    'Authorization': 'Bearer fnd_12345678901234567890abcdef',
    'Content-Type': 'application/json'
  }
});
```

**Example with Python:**
```python
import requests

headers = {
    'Authorization': 'Bearer fnd_12345678901234567890abcdef',
    'Content-Type': 'application/json'
}

response = requests.get(
    'https://api.findoora.com/v1/search?q=documents',
    headers=headers
)
```

## API Key Management

### Key Properties

Each API key has the following properties:

| Property | Description |
|----------|-------------|
| **Name** | Human-readable identifier |
| **Key** | The actual authentication token |
| **Scope** | Permissions granted to this key |
| **Created** | When the key was generated |
| **Last Used** | Most recent API call |
| **Status** | Active, Inactive, or Expired |

### Security Best Practices

import { Callout } from 'nextra/components'

<Callout type="warning" emoji="üîí">
**Security Guidelines:**
- Never hardcode API keys in your source code
- Use environment variables to store keys
- Rotate keys regularly (every 90 days recommended)
- Use different keys for different applications
- Monitor key usage for suspicious activity
- Revoke unused or compromised keys immediately
</Callout>

### Key Scopes

Control what each API key can access:

**Read Scopes:**
- `search:read` - Search through content
- `content:read` - Read content details
- `collections:read` - Access collections
- `user:read` - Read user information

**Write Scopes:**
- `content:write` - Create and modify content
- `collections:write` - Manage collections
- `user:write` - Update user settings

**Admin Scopes:**
- `admin:read` - Read admin information
- `admin:write` - Administrative actions

**Example scoped key:**
```json
{
  "name": "Mobile App Key",
  "scopes": ["search:read", "content:read", "collections:write"]
}
```

## OAuth 2.0 Authentication

For applications that need to act on behalf of users, OAuth 2.0 provides secure authorization.

### OAuth Flow

import { Tabs, Tab } from 'nextra/components'

<Tabs items={['Authorization Code', 'Client Credentials', 'Device Code']}>
  <Tab>
    **Best for**: Web applications, mobile apps with backends
    
    ```
    1. Redirect user to authorization URL
    2. User grants permission
    3. Receive authorization code
    4. Exchange code for access token
    5. Use access token for API calls
    ```
    
    **Authorization URL:**
    ```
    https://auth.findoora.com/oauth/authorize?
      client_id=YOUR_CLIENT_ID&
      response_type=code&
      scope=search:read content:read&
      redirect_uri=YOUR_REDIRECT_URI&
      state=RANDOM_STATE_STRING
    ```
  </Tab>
  <Tab>
    **Best for**: Server-to-server applications
    
    ```
    1. Send client credentials to token endpoint
    2. Receive access token
    3. Use access token for API calls
    ```
    
    **Token Request:**
    ```bash
    curl -X POST https://auth.findoora.com/oauth/token \
      -H "Content-Type: application/x-www-form-urlencoded" \
      -d "grant_type=client_credentials" \
      -d "client_id=YOUR_CLIENT_ID" \
      -d "client_secret=YOUR_CLIENT_SECRET" \
      -d "scope=search:read"
    ```
  </Tab>
  <Tab>
    **Best for**: CLI tools, IoT devices without browsers
    
    ```
    1. Request device code
    2. Display user code
    3. Poll for authorization
    4. Receive access token
    ```
    
    **Device Code Request:**
    ```bash
    curl -X POST https://auth.findoora.com/oauth/device \
      -H "Content-Type: application/x-www-form-urlencoded" \
      -d "client_id=YOUR_CLIENT_ID" \
      -d "scope=search:read"
    ```
  </Tab>
</Tabs>

### Registering OAuth Applications

1. Go to Settings ‚Üí Developer ‚Üí OAuth Applications
2. Click "New Application"
3. Fill in application details:
   - **Name**: Your application name
   - **Description**: What your app does
   - **Redirect URIs**: Valid callback URLs
   - **Scopes**: Required permissions
4. Receive client ID and secret

### Access Token Usage

Once you have an access token, use it like an API key:

```http
Authorization: Bearer ACCESS_TOKEN
```

**Token Response:**
```json
{
  "access_token": "fnd_access_abc123...",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "fnd_refresh_xyz789...",
  "scope": "search:read content:read"
}
```

## Token Refresh

Access tokens expire for security. Use refresh tokens to get new access tokens:

```bash
curl -X POST https://auth.findoora.com/oauth/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "grant_type=refresh_token" \
  -d "refresh_token=fnd_refresh_xyz789..." \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET"
```

## Authentication Errors

### Common Error Codes

| Code | Error | Description |
|------|-------|-------------|
| **401** | `unauthorized` | Missing or invalid credentials |
| **403** | `forbidden` | Valid credentials but insufficient permissions |
| **429** | `rate_limited` | Too many requests, slow down |

### Error Response Format

```json
{
  "error": {
    "code": "invalid_token",
    "message": "The provided token is invalid or expired",
    "details": {
      "token_type": "api_key",
      "expired_at": "2024-01-15T10:30:00Z"
    }
  }
}
```

### Troubleshooting Authentication

**Invalid API Key:**
```bash
# Test your API key
curl -I -H "Authorization: Bearer YOUR_API_KEY" \
     https://api.findoora.com/v1/user
```

**Expired Token:**
- Check token expiration time
- Use refresh token to get new access token
- Generate new API key if needed

**Insufficient Permissions:**
- Verify key scopes match required permissions
- Check user permissions in web interface
- Contact admin for additional access

## Environment Configuration

### Development Setup

Create a `.env` file for local development:

```bash
# .env
FINDOORA_API_KEY=fnd_12345678901234567890abcdef
FINDOORA_BASE_URL=https://api.findoora.com/v1
FINDOORA_CLIENT_ID=your_oauth_client_id
FINDOORA_CLIENT_SECRET=your_oauth_client_secret
```

### Production Security

**Environment Variables:**
```bash
export FINDOORA_API_KEY="fnd_prod_key_here"
export FINDOORA_BASE_URL="https://api.findoora.com/v1"
```

**Container Secrets:**
```yaml
# docker-compose.yml
services:
  app:
    environment:
      - FINDOORA_API_KEY_FILE=/run/secrets/findoora_api_key
    secrets:
      - findoora_api_key

secrets:
  findoora_api_key:
    external: true
```

## SDK Authentication

### JavaScript/Node.js

```javascript
import { Findoora } from 'findoora-js';

// API Key
const client = new Findoora({
  apiKey: process.env.FINDOORA_API_KEY
});

// OAuth
const client = new Findoora({
  clientId: process.env.FINDOORA_CLIENT_ID,
  clientSecret: process.env.FINDOORA_CLIENT_SECRET,
  accessToken: 'your_access_token'
});
```

### Python

```python
from findoora import Client

# API Key
client = Client(api_key=os.environ['FINDOORA_API_KEY'])

# OAuth
client = Client(
    client_id=os.environ['FINDOORA_CLIENT_ID'],
    client_secret=os.environ['FINDOORA_CLIENT_SECRET'],
    access_token='your_access_token'
)
```

### PHP

```php
use Findoora\Client;

// API Key
$client = new Client([
    'api_key' => $_ENV['FINDOORA_API_KEY']
]);

// OAuth
$client = new Client([
    'client_id' => $_ENV['FINDOORA_CLIENT_ID'],
    'client_secret' => $_ENV['FINDOORA_CLIENT_SECRET'],
    'access_token' => 'your_access_token'
]);
```

## Security Considerations

### API Key Security

<Callout type="error" emoji="üö®">
**Never expose API keys in:**
- Frontend JavaScript code
- Public repositories
- Client-side applications
- URLs or query parameters
- Log files or error messages
</Callout>

### Rate Limiting

Authentication affects rate limits:

- **API Keys**: Per-key rate limits
- **OAuth**: Per-user rate limits
- **Anonymous**: Very restrictive limits

### Monitoring

Enable security monitoring:

1. **API Usage Alerts**: Get notified of unusual activity
2. **Failed Authentication Logs**: Track failed login attempts
3. **Key Usage Reports**: Regular usage summaries
4. **Security Notifications**: Account security updates

## Testing Authentication

### Test Scripts

**Basic connectivity test:**
```bash
#!/bin/bash
API_KEY="your_api_key_here"
BASE_URL="https://api.findoora.com/v1"

echo "Testing API connectivity..."
response=$(curl -s -w "%{http_code}" -H "Authorization: Bearer $API_KEY" "$BASE_URL/user")
http_code="${response: -3}"

if [ "$http_code" -eq 200 ]; then
    echo "‚úÖ Authentication successful"
else
    echo "‚ùå Authentication failed (HTTP $http_code)"
fi
```

**OAuth flow test:**
```javascript
// Test OAuth flow
async function testOAuth() {
  const authUrl = `https://auth.findoora.com/oauth/authorize?` +
    `client_id=${CLIENT_ID}&` +
    `response_type=code&` +
    `scope=search:read&` +
    `redirect_uri=${REDIRECT_URI}`;
  
  console.log('Visit this URL to authorize:', authUrl);
}
```

## Migration Guide

### From v1 to v2 Authentication

If you're migrating from API v1:

1. **Update base URL**: Change from `/v1/` to `/v2/`
2. **New key format**: Keys now start with `fnd_`
3. **Scope requirements**: Some endpoints now require specific scopes
4. **Token expiration**: Shorter token lifetimes for security

### Legacy Key Support

Legacy API keys are supported until December 2024:

- Generate new keys before the deadline
- Update applications gradually
- Monitor legacy key usage
- Plan migration timeline

---

## Next Steps

Now that you understand authentication:

- Explore the [Search API](/api/search-api) to start building
- Check [Rate Limits](/api/rate-limits) for usage guidelines
- Review [SDK Libraries](/api/sdk-libraries) for your language
- See [Webhooks](/api/webhooks) for real-time notifications

Need help? Contact our [API support team](mailto:api-support@findoora.com) for assistance with authentication setup.
